<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生照片学习与检测系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 900px;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 32px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }
        
        .description {
            color: #555;
            margin-bottom: 30px;
            font-size: 16px;
            line-height: 1.5;
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .folder-selector, .mode-selector {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            flex: 1;
            min-width: 250px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .folder-selector h2, .mode-selector h2 {
            color: #34495e;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .folders {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .folder-btn {
            padding: 12px 20px;
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .folder-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        .folder-btn.active {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            transform: translateY(-2px);
        }
        
        .modes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .mode-btn {
            padding: 15px;
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        .mode-btn.active {
            background: linear-gradient(to right, #e67e22, #d35400);
            transform: translateY(-2px);
        }
        
        .content-area {
            margin: 30px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .image-container {
            position: relative;
            width: 320px;
            height: 420px;
            margin: 0 auto;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background-color: #f5f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
        }
        
        .image-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }
        
        .image-placeholder {
            color: #7f8c8d;
            font-size: 18px;
            padding: 20px;
            text-align: center;
        }
        
        .student-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .image-mask {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20%; /* 遮盖底部20%，显示80% */
            background: linear-gradient(to bottom, transparent, #f5f7fa 30%);
            z-index: 10;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 14px 30px;
            background: linear-gradient(to right, #9b59b6, #8e44ad);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-width: 160px;
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        .action-btn:active {
            transform: translateY(1px);
        }
        
        .action-btn:disabled {
            background: linear-gradient(to right, #95a5a6, #7f8c8d);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .status-bar {
            margin-top: 20px;
            color: #7f8c8d;
            font-size: 16px;
        }
        
        .hidden {
            display: none;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .control-panel {
                flex-direction: column;
            }
            
            .folder-selector, .mode-selector {
                min-width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .action-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .image-container {
                width: 280px;
                height: 370px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>学生照片学习与检测系统</h1>
        <p class="description">选择班级和模式开始练习或检测。练习模式显示完整照片，检测模式隐藏照片底部20%。</p>
        
        <div class="control-panel">
            <div class="folder-selector">
                <h2>选择班级</h2>
                <div class="folders">
                    <button class="folder-btn" data-folder="1班">1班</button>
                    <button class="folder-btn" data-folder="2班">2班</button>
                    <button class="folder-btn" data-folder="6班">6班</button>
                    <button class="folder-btn" data-folder="11班">11班</button>
                </div>
            </div>
            
            <div class="mode-selector">
                <h2>选择模式</h2>
                <div class="modes">
                    <button class="mode-btn" data-mode="practice">练习模式</button>
                    <button class="mode-btn" data-mode="test">检测模式</button>
                </div>
            </div>
        </div>
        
        <div class="content-area">
            <div class="image-container">
                <div class="image-placeholder">请选择班级和模式开始</div>
                <img class="student-image hidden" src="" alt="学生照片">
                <div class="image-mask hidden"></div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn" id="next-btn" disabled>下一张</button>
                <button class="action-btn" id="show-full-btn" disabled>显示完整照片</button>
            </div>
            
            <div class="status-bar" id="status">准备就绪</div>
        </div>
    </div>

    <script>
        // DOM元素
        const folderButtons = document.querySelectorAll('.folder-btn');
        const modeButtons = document.querySelectorAll('.mode-btn');
        const imagePlaceholder = document.querySelector('.image-placeholder');
        const studentImage = document.querySelector('.student-image');
        const imageMask = document.querySelector('.image-mask');
        const nextBtn = document.getElementById('next-btn');
        const showFullBtn = document.getElementById('show-full-btn');
        const statusBar = document.getElementById('status');

        // 状态变量
        let currentMode = ''; // 'practice' 或 'test'
        let currentClass = '';
        let currentImageIndex = -1;
        let isFullImageVisible = false;
        let images = [];

        // 事件监听
        folderButtons.forEach(button => {
            button.addEventListener('click', function() {
                // 移除所有按钮的active类
                folderButtons.forEach(btn => btn.classList.remove('active'));
                // 为当前按钮添加active类
                this.classList.add('active');
                
                currentClass = this.getAttribute('data-folder');
                statusBar.textContent = `已选择班级: ${currentClass}`;
                
                if (currentMode) {
                    loadClassImages();
                }
            });
        });

        modeButtons.forEach(button => {
            button.addEventListener('click', function() {
                // 移除所有按钮的active类
                modeButtons.forEach(btn => btn.classList.remove('active'));
                // 为当前按钮添加active类
                this.classList.add('active');
                
                currentMode = this.getAttribute('data-mode');
                statusBar.textContent = `已选择模式: ${currentMode === 'practice' ? '练习模式' : '检测模式'}`;
                
                if (currentClass) {
                    loadClassImages();
                }
            });
        });

        nextBtn.addEventListener('click', showNextImage);
        showFullBtn.addEventListener('click', toggleFullImage);

        // 加载班级图片
        async function loadClassImages() {
            if (!currentClass) return;
            
            statusBar.innerHTML = `<span class="loading"></span> 正在加载${currentClass}的照片...`;
            
            try {
                // 尝试从服务器获取照片列表
                // 这里需要根据实际服务器配置进行调整
                images = await getImageList(currentClass);
                
                if (images.length === 0) {
                    statusBar.textContent = `在${currentClass}文件夹中未找到照片`;
                    resetUI();
                    return;
                }
                
                statusBar.textContent = `已加载 ${images.length} 张照片`;
                
                // 启用按钮
                nextBtn.disabled = false;
                showFullBtn.disabled = currentMode !== 'test';
                
                // 隐藏占位符，显示图片容器
                imagePlaceholder.classList.add('hidden');
                studentImage.classList.remove('hidden');
                
                // 根据模式设置初始状态
                if (currentMode === 'test') {
                    isFullImageVisible = false;
                    imageMask.classList.remove('hidden');
                    showFullBtn.textContent = '显示完整照片';
                } else {
                    isFullImageVisible = true;
                    imageMask.classList.add('hidden');
                    showFullBtn.textContent = '显示完整照片';
                }
                
                // 显示第一张随机照片
                showRandomImage();
            } catch (error) {
                console.error('加载照片失败:', error);
                statusBar.textContent = '加载照片失败，请检查服务器配置';
                resetUI();
            }
        }

        // 获取图片列表（需要根据服务器配置调整）
        async function getImageList(className) {
            // 这里假设服务器上有对应的API可以返回图片列表
            // 如果没有API，可以尝试直接列出目录中的文件（需要服务器支持目录列表）
            
            // 方法1: 使用服务器API获取图片列表
            // const response = await fetch(`/api/images?class=${className}`);
            // return await response.json();
            
            // 方法2: 直接尝试加载已知的图片（适用于图片命名有规律的情况）
            // 这里使用模拟数据，实际使用时需要替换为真实的图片路径
            const mockImages = {
                "1班": ['1/student1.jpg', '1/student2.jpg', '1/student3.jpg', '1/student4.jpg', '1/student5.jpg',
						'1/student6.jpg', '1/student7.jpg', '1/student8.jpg', '1/student9.jpg', '1/student10.jpg',
						'1/student11.jpg', '1/student12.jpg', '1/student13.jpg', '1/student14.jpg', '1/student15.jpg',
						'1/student16.jpg', '1/student17.jpg', '1/student18.jpg', '1/student19.jpg', '1/student20.jpg',
						'1/student21.jpg', '1/student22.jpg', '1/student23.jpg', '1/student24.jpg', '1/student25.jpg',
						'1/student26.jpg', '1/student27.jpg', '1/student28.jpg', '1/student29.jpg', '1/student30.jpg',
						'1/student31.jpg', '1/student32.jpg', '1/student33.jpg', '1/student34.jpg', '1/student35.jpg',
						'1/student36.jpg', '1/student37.jpg', '1/student38.jpg', '1/student39.jpg', '1/student40.jpg',
						'1/student41.jpg', '1/student42.jpg', '1/student43.jpg', '1/student44.jpg', '1/student45.jpg',
				],
                "2班": [
                    '2/student1.jpg', '2/student2.jpg', '2/student3.jpg', '2/student4.jpg', '2/student5.jpg',
					'2/student6.jpg', '2/student7.jpg', '2/student8.jpg', '2/student9.jpg', '2/student10.jpg',
					'2/student11.jpg', '2/student12.jpg', '2/student13.jpg', '2/student14.jpg', '2/student15.jpg',
					'2/student16.jpg', '2/student17.jpg', '2/student18.jpg', '2/student19.jpg', '2/student20.jpg', 
					'2/student21.jpg', '2/student22.jpg', '2/student23.jpg', '2/student24.jpg', '2/student25.jpg', 
					'2/student26.jpg', '2/student27.jpg', '2/student28.jpg', '2/student29.jpg', '2/student30.jpg', 
					'2/student31.jpg', '2/student32.jpg', '2/student33.jpg', '2/student34.jpg', '2/student35.jpg', 
					'2/student36.jpg', '2/student37.jpg', '2/student38.jpg', '2/student39.jpg', '2/student40.jpg',
					'2/student41.jpg', '2/student42.jpg', '2/student43.jpg', '2/student44.jpg', '2/student45.jpg',
					'2/student46.jpg'
                ],
                "6班": ['6/student1.jpg', '6/student2.jpg', '6/student3.jpg', '6/student4.jpg', '6/student5.jpg',
				'6/student6.jpg', '6/student7.jpg', '6/student8.jpg', '6/student9.jpg', '6/student10.jpg',
				'6/student11.jpg', '6/student12.jpg', '6/student13.jpg', '6/student14.jpg', '6/student15.jpg', 
				'6/student16.jpg', '6/student17.jpg', '6/student18.jpg', '6/student19.jpg', '6/student20.jpg', 
				'6/student21.jpg', '6/student22.jpg', '6/student23.jpg', '6/student24.jpg', '6/student25.jpg',
				'6/student26.jpg', '6/student27.jpg', '6/student28.jpg', '6/student29.jpg', '6/student30.jpg',
				'6/student31.jpg', '6/student32.jpg', '6/student33.jpg', '6/student34.jpg', '6/student35.jpg',
				'6/student36.jpg', '6/student37.jpg', '6/student38.jpg', '6/student39.jpg', '6/student40.jpg'
                ],
                "11班": [
                    '11/student1.jpg', '11/student2.jpg', '11/student3.jpg', '11/student4.jpg', '11/student5.jpg',
					'11/student6.jpg', '11/student7.jpg', '11/student8.jpg', '11/student9.jpg', '11/student10.jpg',
					'11/student11.jpg', '11/student12.jpg', '11/student13.jpg', '11/student14.jpg', '11/student15.jpg',
					'11/student16.jpg', '11/student17.jpg', '11/student18.jpg', '11/student19.jpg', '11/student20.jpg',
					'11/student21.jpg', '11/student22.jpg', '11/student23.jpg', '11/student24.jpg', '11/student25.jpg',
					'11/student26.jpg', '11/student27.jpg', '11/student28.jpg', '11/student29.jpg', '11/student30.jpg',
					'11/student31.jpg', '11/student32.jpg', '11/student33.jpg', '11/student34.jpg', '11/student35.jpg',
					'11/student36.jpg', '11/student37.jpg', '11/student38.jpg', '11/student39.jpg', '11/student40.jpg', 
					'11/student41.jpg', '11/student42.jpg', '11/student43.jpg', '11/student44.jpg', '11/student45.jpg', 
					'11/student46.jpg', '11/student47.jpg', '11/student48.jpg', '11/student49.jpg', '11/student50.jpg',
					'11/student51.jpg', '11/student52.jpg', '11/student53.jpg'
                ]
				
            };
            
            // 返回模拟数据
            return mockImages[className] || [];
            
            // 实际使用时，可以尝试使用以下方法获取目录中的文件列表
            // 但这需要服务器配置允许目录列表，并且有相应的权限
            // 例如：使用fetch请求目录路径，然后解析返回的HTML获取文件列表
        }

        // 重置UI状态
        function resetUI() {
            images = [];
            currentImageIndex = -1;
            isFullImageVisible = false;
            
            // 禁用按钮
            nextBtn.disabled = true;
            showFullBtn.disabled = true;
            
            // 显示占位符
            imagePlaceholder.classList.remove('hidden');
            studentImage.classList.add('hidden');
            imageMask.classList.add('hidden');
        }

        // 显示随机照片
        function showRandomImage() {
            if (images.length === 0) return;
            
            const randomIndex = Math.floor(Math.random() * images.length);
            // 确保不连续显示同一张照片
            if (randomIndex === currentImageIndex && images.length > 1) {
                return showRandomImage();
            }
            
            currentImageIndex = randomIndex;
            
            // 设置图片
            studentImage.src = images[randomIndex];
            
            // 根据模式设置显示状态
            if (currentMode === 'practice' || isFullImageVisible) {
                imageMask.classList.add('hidden');
            } else {
                imageMask.classList.remove('hidden');
            }
            
            statusBar.textContent = `当前显示: ${currentMode === 'practice' ? '完整照片' : '部分照片'} (${currentImageIndex + 1}/${images.length})`;
        }

        // 显示下一张照片
        function showNextImage() {
            if (currentMode === 'test') {
                isFullImageVisible = false;
                imageMask.classList.remove('hidden');
                showFullBtn.textContent = '显示完整照片';
            }
            showRandomImage();
        }

        // 切换完整照片可见性（仅检测模式）
        function toggleFullImage() {
            if (currentMode !== 'test') return;
            
            isFullImageVisible = !isFullImageVisible;
            
            if (isFullImageVisible) {
                imageMask.classList.add('hidden');
                showFullBtn.textContent = '隐藏部分照片';
                statusBar.textContent = '显示完整照片';
            } else {
                imageMask.classList.remove('hidden');
                showFullBtn.textContent = '显示完整照片';
                statusBar.textContent = '显示部分照片（隐藏底部20%）';
            }
        }
    </script>
</body>
</html>